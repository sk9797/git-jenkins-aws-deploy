pipeline {
    agent any
    environment {
      AWS_DEFAULT_REGION= "ap-south-1"
      AWS_ACCESS_KEY_ID=  "AKIAVGIPNHVQE67IYAXZ"
      AWS_SECRET_ACCESS_KEY= "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"
    }
    stages {
      stage('Checkout') {
        steps{
        //disable to recycle workspace data to save time/bandwidth
        deleteDir()
        checkout scm

        //enable for commit id in build number
        //env.git_commit_id = sh returnStdout: true, script: 'git rev-parse HEAD'
        //env.git_commit_id_short = env.git_commit_id.take(7)
        //currentBuild.displayName = "#${currentBuild.number}-${env.git_commit_id_short}"
        }
      }
      stage('npm install') {
        steps{
          echo 'npm install started'
          bat "npm install"
          echo 'npm install finished'
        }
      }
      stage('Build Stage') {
        steps {
          echo 'npm build started'
          bat "npm run build"
          echo 'npm build finished'
          bat "cd dist"
          bat "dir"
        }
      }
      // stage('deploy to s3') {
      //     steps {
      //       bat "aws configure set region $AWS_DEFAULT_REGION" 
      //       bat "aws configure set aws_access_key_id $AWS_ACCESS_KEY_ID"  
      //       bat "aws configure set aws_secret_access_key $AWS_SECRET_ACCESS_KEY"
      //       bat "aws s3 cp dist/git-jenkins-aws-deploy/index.html s3://aws-jekins-bucket --recursive"
      //     }
      //   }
      }
}